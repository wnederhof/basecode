package {{ groupId }}.{{ artifactId }}.{{ name_lowercase }}

{{#each fields}}{{#if fieldRelationship}}import {{ groupId }}.{{ artifactId }}.{{ fieldType_lowercase }}.{{ FieldType }}
import {{ groupId }}.{{ artifactId }}.{{ fieldType_lowercase }}.{{ FieldType }}Service
{{/if}}{{/each}}import graphql.kickstart.tools.GraphQLMutationResolver
import graphql.kickstart.tools.GraphQLQueryResolver{{#if hasRelations}}
import graphql.kickstart.tools.GraphQLResolver{{/if}}
import org.springframework.beans.factory.annotation.Autowired
import org.springframework.stereotype.Component

sealed class {{ Name }}Resolver {

    @Autowired
    protected lateinit var {{ name }}Service: {{ Name }}Service
{{#each fields}}{{#if fieldRelationship}}
    @Autowired
    protected lateinit var {{ fieldType }}Service: {{ FieldType }}Service
{{/if}}{{/each}}
    @Component
    class RootQueryResolver : GraphQLQueryResolver, {{ Name }}Resolver() {
        fun {{ name }}(id: Int): {{ Name }}? {
            return {{ name }}Service.findById(id)
        }

        fun {{ names }}({{#if hasRelations}}filter: {{ Name }}.{{ Name }}FilterInput?{{/if}}): Iterable<{{ Name }}> {
            return {{ name }}Service.findAll({{#if hasRelations}}filter{{/if}})
        }
    }

    @Component
    class MutationResolver : GraphQLMutationResolver, {{ Name }}Resolver() {
        fun create{{ Name }}(input: {{ Name }}.Create{{ Name }}Input): {{ Name }} {
            return {{ name }}Service.create(input)
        }

        fun update{{ Name }}(id: Int, input: {{ Name }}.Update{{ Name }}Input): {{ Name }}? {
            return {{ name }}Service.update(id, input)
        }

        fun delete{{ Name }}(id: Int) {
            {{ name }}Service.deleteById(id)
        }
    }
{{#if hasRelations}}
    @Component
    class {{ Name }}QueryResolver : GraphQLResolver<{{ Name }}>, {{ Name }}Resolver() { {{#each fields}}{{#if fieldRelationship}}
        fun {{ fieldType }}({{ name }}: {{ Name }}): {{ FieldType }}? {
            return {{ fieldType }}Service.findById({{ name }}.{{ fieldName }})
        }
{{/if}}{{/each}}    }
{{#each fields}}{{#if fieldRelationship}}
    @Component
    class {{ FieldType }}FieldResolver : GraphQLResolver<{{ FieldType }}>, {{ Name }}Resolver() {
        fun {{ names }}({{ fieldType }}: {{ FieldType }}): List<{{ Name }}> {
            return {{ name }}Service.findBy{{ FieldName }}({{ fieldType }}.id!!)
        }
    }
{{/if}}{{/each}}{{/if}}
}
